#!/usr/bin/env php
<?php

namespace Lkrms\Tests\Cli;

use Lkrms\Cli\CliApplication;
use Lkrms\Tests\Cli\Command\TestOptions;
use Throwable;

require __DIR__ . '/../../vendor/autoload.php';

$app = new CliApplication(dirname(__DIR__));

$exceptions = [];

// Register TestOptions as the only command
$app->command([], TestOptions::class);

try {
    // Try to register it under another name
    $app->command(['test', 'options'], TestOptions::class);
} catch (Throwable $ex) {
    $exceptions[] = $ex;
}

print_r([
    'exceptions' => array_map(function (Throwable $ex) { return $ex->getMessage(); }, $exceptions),
]);

$status = $app->run();
exit ($status);
