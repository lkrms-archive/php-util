#!/usr/bin/env php
<?php

namespace Lkrms\Tests;

use Lkrms\Cache;
use Lkrms\Err;

$loader = require (__DIR__ . "/../vendor/autoload.php");
$loader->addPsr4("Lkrms\\Tests\\", __DIR__);

Err::HandleErrors();

Cache::Load();

Cache::Set('key', 'value1');
print_r(Cache::Get('key'));

Cache::Set('key', ['value1', 'value2']);
print_r(Cache::Get('key'));

print_r(Cache::MaybeGet(
    [basename(__FILE__), "MaybeGet"],
    function ()
    {
        return [
            "key1" => "value1",
            "key2" => "value2",
        ];
    }, 2
));

foreach ([1, 2] as $seconds)
{
    sleep($seconds);
    print_r(Cache::MaybeGet(
        [basename(__FILE__), "MaybeGet"],
        "time"
    ));
}

